<!doctype html><html lang="fr"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>MonCarnetEPS</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
    body{font-family:Inter,system-ui,Arial;margin:0;padding:24px;background:#f7f9fc}
    .card{max-width:920px;margin:0 auto;background:#fff;border-radius:14px;padding:18px;box-shadow:0 8px 24px rgba(0,0,0,.06)}
    .hidden{display:none}.bigbtn{padding:12px 16px;border:0;border-radius:10px;background:#34c759;color:#fff;font-weight:800;cursor:pointer}
    .smallbtn{padding:8px 12px;border:1px solid #eee;border-radius:10px;background:#fff;cursor:pointer}
    </style></head><body>
    <div class="card" id="panel-splash"><h1>MonCarnetEPS</h1><p>Carnet d'entraînement</p><button id="btnStart" class="bigbtn">Démarrer</button></div>
    <div class="card hidden" id="panel-dashboard"><h2 id="profileLine">—</h2>
    <button id="btnExportPDF" class="bigbtn">Générer PDF</button> <button id="btnExportCSV" class="smallbtn">Exporter CSV</button></div>
    <script>
      const $=id=>document.getElementById(id); const STORAGE_KEY='scancarnet_v8'; function getDB(){ try{return JSON.parse(localStorage.getItem(STORAGE_KEY)||'{}')}catch(e){return {}}}
      function saveDB(d){ localStorage.setItem(STORAGE_KEY, JSON.stringify(d)); }
      if(!getDB().profile){ saveDB({profile:{nom:'',prenom:'',classe:''}, cycles:[{id:'c1',name:'Badminton',warmup:'Footing 8min',sessions:[{id:'s1',dateISO:'2025-09-28',text:'Séance test',created_atISO:new Date().toISOString()}]}],selected:'c1'})}
      $('btnStart').onclick=()=>{ $('panel-splash').classList.add('hidden'); $('panel-dashboard').classList.remove('hidden'); document.getElementById('profileLine').textContent='Demo'; };
      $('btnExportCSV').onclick=()=>{ const d=getDB(); const c=d.cycles.find(x=>x.id===d.selected); const head=['nom','prenom','classe','cycle','date','texte','echauffement','created_at']; const rows=(c.sessions||[]).map(s=>[d.profile.nom,d.profile.prenom,d.profile.classe,c.name,s.dateISO,s.text,c.warmup,s.created_atISO]); const esc=v=>`"${String(v??'').replace(/"/g,'""').replace(/\n/g,'\\n')}"`; const csv=[head,...rows].map(r=>r.map(esc).join(';')).join('\n'); const blob=new Blob(['\ufeff'+csv],{type:'text/csv;charset=utf-8'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='demo.csv'; a.click(); URL.revokeObjectURL(url); };
      $('btnExportPDF').onclick=()=>{ const d=getDB(); const c=d.cycles.find(x=>x.id===d.selected); const { jsPDF }=window.jspdf; const pdf=new jsPDF({unit:'pt',format:'a4'}); const W=pdf.internal.pageSize.getWidth(); const H=pdf.internal.pageSize.getHeight(); pdf.setFillColor(10,88,255); pdf.rect(0,0,W,70,'F'); pdf.setTextColor(255,255,255); pdf.setFont('helvetica','bold'); pdf.setFontSize(18); pdf.text(`${c.name} — Carnet d'entraînement`,48,42); pdf.setTextColor(0); pdf.setFont('helvetica','normal'); pdf.setFontSize(12); const lines=pdf.splitTextToSize(c.sessions[0].text, W-96); let y=96; lines.forEach(t=>{ if(y>H-48){ pdf.addPage(); y=96; } pdf.text(t,48,y); y+=14;}); pdf.save('demo.pdf'); };
    </script></body></html>